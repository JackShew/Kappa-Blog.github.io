module.exports=function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={exports:{},id:n,loaded:!1};return t[n].call(i.exports,i,i.exports,e),i.loaded=!0,i.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){"use strict";var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},i=o(4),r=0,a=o(5),s=o(8),u=o(2),c=o(7),h=s.PropTypes,l=2*Math.PI,p=o(1),f=o(6),d=s.createClass({displayName:"Ink",shouldComponentUpdate:f,propTypes:{background:h.bool,duration:h.number,opacity:h.number,radius:h.number,recenter:h.bool,hasTouch:h.bool},getDefaultProps:function(){return{background:!0,duration:1e3,opacity:.25,radius:150,recenter:!0,hasTouch:i}},getInitialState:function(){return{color:"transparent",density:1,height:0,store:c(this.tick),touchEvents:this.touchEvents(),width:0}},touchEvents:function(){return this.props.hasTouch?{onTouchStart:this._onPress,onTouchEnd:this._onRelease,onTouchCancel:this._onRelease}:{onMouseDown:this._onPress,onMouseUp:this._onRelease,onMouseLeave:this._onRelease}},tick:function(){var t=this.state,e=t.ctx,o=t.color,n=t.density,i=t.height,r=t.width,a=t.store;e.save(),e.scale(n,n),e.clearRect(0,0,r,i),e.fillStyle=o,this.props.background&&(e.globalAlpha=a.getTotalOpacity(this.props.opacity),e.fillRect(0,0,r,i)),a.each(this.makeBlot,this),e.restore()},makeBlot:function(t){var e=this.state,o=e.ctx,n=e.height,i=e.width,r=t.x,a=t.y,s=t.radius;if(o.globalAlpha=p.getBlotOpacity(t,this.props.opacity),o.beginPath(),this.props.recenter){var u=Math.max(n,i);r+=p.getBlotShiftX(t,u,i),a+=p.getBlotShiftY(t,u,n)}o.arc(r,a,s*p.getBlotScale(t),0,l),o.closePath(),o.fill()},componentWillUnmount:function(){this.state.store.stop()},pushBlot:function(t,e,o){var n=this,i=this.refs.canvas;i instanceof window.HTMLCanvasElement==!1&&(i=i.getDOMNode());var r=i.getBoundingClientRect(),s=r.top,u=r.bottom,c=r.left,h=r.right,l=window.getComputedStyle(i),f=l.color,d=this.state.ctx||i.getContext("2d"),g=a(d),v=u-s,m=h-c,x=p.getMaxRadius(v,m,this.props.radius);this.setState({color:f,ctx:d,density:g,height:v,width:m},function(){n.state.store.add({duration:n.props.duration,mouseDown:t,mouseUp:0,radius:x,x:e-c,y:o-s})})},render:function(){var t=this.state,e=t.density,o=t.height,i=t.width,r=t.touchEvents;return s.createElement("canvas",n({className:"ink",ref:"canvas",style:n({},u,this.props.style),height:o*e,width:i*e,onDragOver:this._onRelease},r))},_onPress:function(t){var e=t.button,o=t.ctrlKey,n=t.clientX,i=t.clientY,a=t.changedTouches,s=Date.now();if(a)for(var u=0;u<a.length;u++){var c=a[u],h=c.clientX,l=c.clientY;this.pushBlot(s,h,l)}else e!==r||o||this.pushBlot(s,n,i)},_onRelease:function(){this.state.store.release(Date.now())}});t.exports=d},function(t,e,o){"use strict";function n(t){return h(t.duration,Date.now()-t.mouseDown)}function i(t){return t.mouseUp>0?Date.now()-t.mouseUp:0}function r(t){var e=t.duration,o=t.radius,r=.85*a(n(t),0,o,e),s=.15*a(i(t),0,o,e),h=.02*o*u(Date.now()/e);return c(0,r+s+h)}var a=o(3),s=Math.sqrt(2),u=Math.cos,c=Math.max,h=Math.min;t.exports={getMaxRadius:function(t,e,o){return h(.5*c(t,e),o)},getBlotOpacity:function(t,e){return a(i(t),e,-e,t.duration)},getBlotOuterOpacity:function(t,e){return h(this.getBlotOpacity(t,e),a(n(t),0,.3,3*t.duration))},getBlotShiftX:function(t,e,o){return h(1,r(t)/e*2/s)*(o/2-t.x)},getBlotShiftY:function(t,e,o){return h(1,r(t)/e*2/s)*(o/2-t.y)},getBlotScale:function(t){return r(t)/t.radius}}},function(t,e){"use strict";t.exports={borderRadius:"inherit",height:"100%",left:0,position:"absolute",top:0,width:"100%"}},function(t,e){"use strict";t.exports=function(t,e,o,n){return o*((t=t/n-1)*t*t*t*t+1)+e}},function(t,e){"use strict";var o=!1;"undefined"!=typeof window&&(o="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),t.exports=o},function(t,e){"use strict";t.exports=function(t){var e=window.devicePixelRatio||1,o=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return e/o}},function(t,e){"use strict";t.exports=function(t,e){for(var o in t)if(this.props[o]!==t[o])return!0;for(var n in e)if(this.state[n]!==e[n])return!0;return!1}},function(t,e,o){"use strict";var n=o(1),i=function(t){var e=t.mouseUp,o=t.duration;return!e||Date.now()-e<o};t.exports=function(t){var e=[],o=!1,r=void 0,a={each:function(t,o){for(var n=0,i=e.length;n<i;n++)t.call(o,e[n])},play:function(){o||(o=!0,a.update())},stop:function(){o=!1,cancelAnimationFrame(r)},getTotalOpacity:function(t){for(var o=0,i=0,r=e.length;i<r;i++)o+=n.getBlotOuterOpacity(e[i],t);return o},update:function(){e=e.filter(i),e.length?(r=requestAnimationFrame(a.update),t()):a.stop()},add:function(t){e.push(t),a.play()},release:function(t){for(var o=e.length-1;o>=0;o--)if(!e[o].mouseUp)return e[o].mouseUp=t}};return a}},function(t,e){t.exports=require("react")}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vaW5rLmpzIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA2ODhiM2JkMzRhOTMxMGZlOGIwNSIsIndlYnBhY2s6Ly8vLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvZXF1YXRpb25zLmpzIiwid2VicGFjazovLy8uL3NyYy9zdHlsZS5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9lYXNpbmcuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvaGFzVG91Y2guanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL3V0aWwvcGl4ZWxSYXRpby5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvdXRpbC9wdXJlLmpzIiwid2VicGFjazovLy8uL3NyYy91dGlsL3N0b3JlLmpzIiwid2VicGFjazovLy9leHRlcm5hbCBcInJlYWN0XCIiXSwibmFtZXMiOlsibW9kdWxlIiwiZXhwb3J0cyIsIm1vZHVsZXMiLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwibW9kdWxlSWQiLCJpbnN0YWxsZWRNb2R1bGVzIiwiaWQiLCJsb2FkZWQiLCJjYWxsIiwibSIsImMiLCJwIiwiX2V4dGVuZHMiLCJPYmplY3QiLCJhc3NpZ24iLCJ0YXJnZXQiLCJpIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwic291cmNlIiwia2V5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJIQVNfVE9VQ0giLCJNT1VTRV9MRUZUIiwicGl4ZWxSYXRpbyIsIlJlYWN0IiwiU1RZTEUiLCJTdG9yZSIsIlR5cGVzIiwiUHJvcFR5cGVzIiwiVEFVIiwiTWF0aCIsIlBJIiwiRXF1YXRpb25zIiwiUHVyZSIsIkluayIsImNyZWF0ZUNsYXNzIiwiZGlzcGxheU5hbWUiLCJzaG91bGRDb21wb25lbnRVcGRhdGUiLCJwcm9wVHlwZXMiLCJiYWNrZ3JvdW5kIiwiYm9vbCIsImR1cmF0aW9uIiwibnVtYmVyIiwib3BhY2l0eSIsInJhZGl1cyIsInJlY2VudGVyIiwiaGFzVG91Y2giLCJnZXREZWZhdWx0UHJvcHMiLCJnZXRJbml0aWFsU3RhdGUiLCJjb2xvciIsImRlbnNpdHkiLCJoZWlnaHQiLCJzdG9yZSIsInRoaXMiLCJ0aWNrIiwidG91Y2hFdmVudHMiLCJ3aWR0aCIsInByb3BzIiwib25Ub3VjaFN0YXJ0IiwiX29uUHJlc3MiLCJvblRvdWNoRW5kIiwiX29uUmVsZWFzZSIsIm9uVG91Y2hDYW5jZWwiLCJvbk1vdXNlRG93biIsIm9uTW91c2VVcCIsIm9uTW91c2VMZWF2ZSIsIl9zdGF0ZSIsInN0YXRlIiwiY3R4Iiwic2F2ZSIsInNjYWxlIiwiY2xlYXJSZWN0IiwiZmlsbFN0eWxlIiwiZ2xvYmFsQWxwaGEiLCJnZXRUb3RhbE9wYWNpdHkiLCJmaWxsUmVjdCIsImVhY2giLCJtYWtlQmxvdCIsInJlc3RvcmUiLCJibG90IiwiX3N0YXRlMiIsIngiLCJ5IiwiZ2V0QmxvdE9wYWNpdHkiLCJiZWdpblBhdGgiLCJzaXplIiwibWF4IiwiZ2V0QmxvdFNoaWZ0WCIsImdldEJsb3RTaGlmdFkiLCJhcmMiLCJnZXRCbG90U2NhbGUiLCJjbG9zZVBhdGgiLCJmaWxsIiwiY29tcG9uZW50V2lsbFVubW91bnQiLCJzdG9wIiwicHVzaEJsb3QiLCJ0aW1lU3RhbXAiLCJjbGllbnRYIiwiY2xpZW50WSIsIl90aGlzIiwiZWwiLCJyZWZzIiwiY2FudmFzIiwid2luZG93IiwiSFRNTENhbnZhc0VsZW1lbnQiLCJnZXRET01Ob2RlIiwiX2VsJGdldEJvdW5kaW5nQ2xpZW50IiwiZ2V0Qm91bmRpbmdDbGllbnRSZWN0IiwidG9wIiwiYm90dG9tIiwibGVmdCIsInJpZ2h0IiwiX3dpbmRvdyRnZXRDb21wdXRlZFN0IiwiZ2V0Q29tcHV0ZWRTdHlsZSIsImdldENvbnRleHQiLCJnZXRNYXhSYWRpdXMiLCJzZXRTdGF0ZSIsImFkZCIsIm1vdXNlRG93biIsIm1vdXNlVXAiLCJyZW5kZXIiLCJfc3RhdGUzIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInJlZiIsInN0eWxlIiwib25EcmFnT3ZlciIsImUiLCJidXR0b24iLCJjdHJsS2V5IiwiY2hhbmdlZFRvdWNoZXMiLCJEYXRlIiwibm93IiwiX2NoYW5nZWRUb3VjaGVzJGkiLCJyZWxlYXNlIiwiZ2V0UHJlc3MiLCJtaW4iLCJnZXRSZWxlYXNlIiwiZ2V0UmFkaXVzIiwiZG93biIsImVhc2luZyIsInVwIiwidW5kdWxhdGlvbiIsImNvcyIsIlNRUlRfMiIsInNxcnQiLCJnZXRCbG90T3V0ZXJPcGFjaXR5IiwiYm9yZGVyUmFkaXVzIiwicG9zaXRpb24iLCJ0IiwiYiIsImQiLCJEb2N1bWVudFRvdWNoIiwiZG9jdW1lbnQiLCJjb250ZXh0IiwiZGV2aWNlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVJhdGlvIiwid2Via2l0QmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsIm1vekJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJtc0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJvQmFja2luZ1N0b3JlUGl4ZWxSYXRpbyIsImJhY2tpbmdTdG9yZVBpeGVsUmF0aW8iLCJzIiwia2lsbFN0YWxlIiwiX3JlZiIsInB1YmxpY2l6ZSIsIl9kYXRhIiwiX3BsYXlpbmciLCJfZnJhbWUiLCJjYWxsYmFjayIsInNjb3BlIiwibCIsInBsYXkiLCJ1cGRhdGUiLCJjYW5jZWxBbmltYXRpb25GcmFtZSIsImFuc3dlciIsImZpbHRlciIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInB1c2giLCJ0aW1lIiwicmVxdWlyZSJdLCJtYXBwaW5ncyI6IkFBQUFBLE9BQU9DLFFBQ0UsU0FBVUMsR0NHbkIsUUFBQUMsR0FBQUMsR0FHQSxHQUFBQyxFQUFBRCxHQUNBLE1BQUFDLEdBQUFELEdBQUFILE9BR0EsSUFBQUQsR0FBQUssRUFBQUQsSUFDQUgsV0FDQUssR0FBQUYsRUFDQUcsUUFBQSxFQVVBLE9BTkFMLEdBQUFFLEdBQUFJLEtBQUFSLEVBQUFDLFFBQUFELElBQUFDLFFBQUFFLEdBR0FILEVBQUFPLFFBQUEsRUFHQVAsRUFBQUMsUUF2QkEsR0FBQUksS0FxQ0EsT0FUQUYsR0FBQU0s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OUksR0FFRmtELEtBRlUsU0FFTDZGLEVBQVVDLEdBQ2IsSUFBSyxHQUFJNUosR0FBSSxFQUFHNkosRUFBSUwsRUFBTXRKLE9BQVFGLEVBQUk2SixFQUFHN0osSUFDdkMySixFQUFTbkssS0FBS29LLEVBQU9KLEVBQU14SixLQUkvQjhKLEtBUlUsV0FTSEwsSUFDSEEsR0FBVyxFQUNYN0ksRUFBTW1KLFdBSVYvRSxLQWZVLFdBZ0JSeUUsR0FBVyxFQUNYTyxxQkFBcUJOLElBR3ZCOUYsZ0JBcEJVLFNBb0JNL0IsR0FHZCxJQUFLLEdBRkRvSSxHQUFTLEVBRUpqSyxFQUFJLEVBQUc2SixFQUFJTCxFQUFNdEosT0FBUUYsRUFBSTZKLEVBQUc3SixJQUN2Q2lLLEdBQVUvSSxFQUFVa0gsb0JBQW9Cb0IsRUFBTXhKLEdBQUk2QixFQUdwRCxPQUFPb0ksSUFHVEYsT0E5QlUsV0ErQlJQLEVBQVFBLEVBQU1VLE9BQU9iLEdBRWpCRyxFQUFNdEosUUFDUndKLEVBQVNTLHNCQUFzQnZKLEVBQU1tSixRQUNyQ1IsS0FFQTNJLEVBQU1vRSxRQUlWdUIsSUF6Q1UsU0F5Q041RCxHQUNGNkcsRUFBTVksS0FBS3pILEdBQ1gvQixFQUFNa0osUUFHUnRDLFFBOUNVLFNBOENGNkMsR0FDTixJQUFLLEdBQUlySyxHQUFJd0osRUFBTXRKLE9BQVMsRUFBR0YsR0FBSyxFQUFHQSxJQUNyQyxJQUFLd0osRUFBTXhKLEdBQUd5RyxRQUNaLE1BQU8rQyxHQUFNeEosR0FBR3lHLFFBQVU0RCxHQU9sQyxPQUFPekosS1QwWUgsU0FBUzVCLEVBQVFDLEdVamR2QkQsRUFBQUMsUUFBQXFMLFFBQUEiLCJmaWxlIjoiaW5rLmpzIiwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPVxuLyoqKioqKi8gKGZ1bmN0aW9uKG1vZHVsZXMpIHsgLy8gd2VicGFja0Jvb3RzdHJhcFxuLyoqKioqKi8gXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4vKioqKioqLyBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuLyoqKioqKi8gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuLyoqKioqKi8gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuLyoqKioqKi8gXHRcdFx0cmV0dXJuIGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdLmV4cG9ydHM7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4vKioqKioqLyBcdFx0dmFyIG1vZHVsZSA9IGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdID0ge1xuLyoqKioqKi8gXHRcdFx0ZXhwb3J0czoge30sXG4vKioqKioqLyBcdFx0XHRpZDogbW9kdWxlSWQsXG4vKioqKioqLyBcdFx0XHRsb2FkZWQ6IGZhbHNlXG4vKioqKioqLyBcdFx0fTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG4vKioqKioqLyBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG4vKioqKioqL1xuLyoqKioqKi8gXHRcdC8vIEZsYWcgdGhlIG1vZHVsZSBhcyBsb2FkZWRcbi8qKioqKiovIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcbi8qKioqKiovXG4vKioqKioqLyBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbi8qKioqKiovIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4vKioqKioqLyBcdH1cbi8qKioqKiovXG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuLyoqKioqKi8gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuLyoqKioqKi9cbi8qKioqKiovIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbi8qKioqKiovIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcbi8qKioqKiovXG4vKioqKioqLyBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4vKioqKioqLyBcdF9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7XG4vKioqKioqL1xuLyoqKioqKi8gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbi8qKioqKiovIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oMCk7XG4vKioqKioqLyB9KVxuLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi9cbi8qKioqKiovIChbXG4vKiAwICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHR2YXIgX2V4dGVuZHMgPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uICh0YXJnZXQpIHsgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHsgdmFyIHNvdXJjZSA9IGFyZ3VtZW50c1tpXTsgZm9yICh2YXIga2V5IGluIHNvdXJjZSkgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHNvdXJjZSwga2V5KSkgeyB0YXJnZXRba2V5XSA9IHNvdXJjZVtrZXldOyB9IH0gfSByZXR1cm4gdGFyZ2V0OyB9O1xuXHRcblx0LyoqXG5cdCAqIElua1xuXHQgKiBGaWxscyBhIGNvbnRhaW5lciB3aXRoIGFuIFNWRyBvYmplY3QgdGhhdCBwcm92aWRlcyBmZWVkYmFjayBvbiBtb3VzZS90b3VjaFxuXHQgKiBldmVudHMgd2l0aCBhIHJpcHBsaW5nIHBvb2wuXG5cdCAqL1xuXHRcblx0dmFyIEhBU19UT1VDSCA9IF9fd2VicGFja19yZXF1aXJlX18oNCk7XG5cdHZhciBNT1VTRV9MRUZUID0gMDtcblx0dmFyIHBpeGVsUmF0aW8gPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDUpO1xuXHR2YXIgUmVhY3QgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDgpO1xuXHR2YXIgU1RZTEUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDIpO1xuXHR2YXIgU3RvcmUgPSBfX3dlYnBhY2tfcmVxdWlyZV9fKDcpO1xuXHR2YXIgVHlwZXMgPSBSZWFjdC5Qcm9wVHlwZXM7XG5cdHZhciBUQVUgPSBNYXRoLlBJICogMjtcblx0dmFyIEVxdWF0aW9ucyA9IF9fd2VicGFja19yZXF1aXJlX18oMSk7XG5cdHZhciBQdXJlID0gX193ZWJwYWNrX3JlcXVpcmVfXyg2KTtcblx0XG5cdHZhciBJbmsgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XG5cdCAgZGlzcGxheU5hbWU6ICdJbmsnLFxuXHRcblx0XG5cdCAgc2hvdWxkQ29tcG9uZW50VXBkYXRlOiBQdXJlLFxuXHRcblx0ICBwcm9wVHlwZXM6IHtcblx0ICAgIGJhY2tncm91bmQ6IFR5cGVzLmJvb2wsXG5cdCAgICBkdXJhdGlvbjogVHlwZXMubnVtYmVyLFxuXHQgICAgb3BhY2l0eTogVHlwZXMubnVtYmVyLFxuXHQgICAgcmFkaXVzOiBUeXBlcy5udW1iZXIsXG5cdCAgICByZWNlbnRlcjogVHlwZXMuYm9vbCxcblx0ICAgIGhhc1RvdWNoOiBUeXBlcy5ib29sXG5cdCAgfSxcblx0XG5cdCAgZ2V0RGVmYXVsdFByb3BzOiBmdW5jdGlvbiBnZXREZWZhdWx0UHJvcHMoKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBiYWNrZ3JvdW5kOiB0cnVlLFxuXHQgICAgICBkdXJhdGlvbjogMTAwMCxcblx0ICAgICAgb3BhY2l0eTogMC4yNSxcblx0ICAgICAgcmFkaXVzOiAxNTAsXG5cdCAgICAgIHJlY2VudGVyOiB0cnVlLFxuXHQgICAgICBoYXNUb3VjaDogSEFTX1RPVUNIXG5cdCAgICB9O1xuXHQgIH0sXG5cdCAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbiBnZXRJbml0aWFsU3RhdGUoKSB7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBjb2xvcjogJ3RyYW5zcGFyZW50Jyxcblx0ICAgICAgZGVuc2l0eTogMSxcblx0ICAgICAgaGVpZ2h0OiAwLFxuXHQgICAgICBzdG9yZTogU3RvcmUodGhpcy50aWNrKSxcblx0ICAgICAgdG91Y2hFdmVudHM6IHRoaXMudG91Y2hFdmVudHMoKSxcblx0ICAgICAgd2lkdGg6IDBcblx0ICAgIH07XG5cdCAgfSxcblx0ICB0b3VjaEV2ZW50czogZnVuY3Rpb24gdG91Y2hFdmVudHMoKSB7XG5cdCAgICBpZiAodGhpcy5wcm9wcy5oYXNUb3VjaCkge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIG9uVG91Y2hTdGFydDogdGhpcy5fb25QcmVzcyxcblx0ICAgICAgICBvblRvdWNoRW5kOiB0aGlzLl9vblJlbGVhc2UsXG5cdCAgICAgICAgb25Ub3VjaENhbmNlbDogdGhpcy5fb25SZWxlYXNlXG5cdCAgICAgIH07XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIG9uTW91c2VEb3duOiB0aGlzLl9vblByZXNzLFxuXHQgICAgICAgIG9uTW91c2VVcDogdGhpcy5fb25SZWxlYXNlLFxuXHQgICAgICAgIG9uTW91c2VMZWF2ZTogdGhpcy5fb25SZWxlYXNlXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSxcblx0ICB0aWNrOiBmdW5jdGlvbiB0aWNrKCkge1xuXHQgICAgdmFyIF9zdGF0ZSA9IHRoaXMuc3RhdGUsXG5cdCAgICAgICAgY3R4ID0gX3N0YXRlLmN0eCxcblx0ICAgICAgICBjb2xvciA9IF9zdGF0ZS5jb2xvcixcblx0ICAgICAgICBkZW5zaXR5ID0gX3N0YXRlLmRlbnNpdHksXG5cdCAgICAgICAgaGVpZ2h0ID0gX3N0YXRlLmhlaWdodCxcblx0ICAgICAgICB3aWR0aCA9IF9zdGF0ZS53aWR0aCxcblx0ICAgICAgICBzdG9yZSA9IF9zdGF0ZS5zdG9yZTtcblx0XG5cdFxuXHQgICAgY3R4LnNhdmUoKTtcblx0XG5cdCAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSk7XG5cdFxuXHQgICAgY3R4LmNsZWFyUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcblx0XG5cdCAgICBjdHguZmlsbFN0eWxlID0gY29sb3I7XG5cdFxuXHQgICAgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZCkge1xuXHQgICAgICBjdHguZ2xvYmFsQWxwaGEgPSBzdG9yZS5nZXRUb3RhbE9wYWNpdHkodGhpcy5wcm9wcy5vcGFjaXR5KTtcblx0ICAgICAgY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xuXHQgICAgfVxuXHRcblx0ICAgIHN0b3JlLmVhY2godGhpcy5tYWtlQmxvdCwgdGhpcyk7XG5cdFxuXHQgICAgY3R4LnJlc3RvcmUoKTtcblx0ICB9LFxuXHQgIG1ha2VCbG90OiBmdW5jdGlvbiBtYWtlQmxvdChibG90KSB7XG5cdCAgICB2YXIgX3N0YXRlMiA9IHRoaXMuc3RhdGUsXG5cdCAgICAgICAgY3R4ID0gX3N0YXRlMi5jdHgsXG5cdCAgICAgICAgaGVpZ2h0ID0gX3N0YXRlMi5oZWlnaHQsXG5cdCAgICAgICAgd2lkdGggPSBfc3RhdGUyLndpZHRoO1xuXHQgICAgdmFyIHggPSBibG90LngsXG5cdCAgICAgICAgeSA9IGJsb3QueSxcblx0ICAgICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblx0XG5cdFxuXHQgICAgY3R4Lmdsb2JhbEFscGhhID0gRXF1YXRpb25zLmdldEJsb3RPcGFjaXR5KGJsb3QsIHRoaXMucHJvcHMub3BhY2l0eSk7XG5cdCAgICBjdHguYmVnaW5QYXRoKCk7XG5cdFxuXHQgICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcblx0ICAgICAgdmFyIHNpemUgPSBNYXRoLm1heChoZWlnaHQsIHdpZHRoKTtcblx0XG5cdCAgICAgIHggKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpO1xuXHQgICAgICB5ICs9IEVxdWF0aW9ucy5nZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCk7XG5cdCAgICB9XG5cdFxuXHQgICAgY3R4LmFyYyh4LCB5LCByYWRpdXMgKiBFcXVhdGlvbnMuZ2V0QmxvdFNjYWxlKGJsb3QpLCAwLCBUQVUpO1xuXHRcblx0ICAgIGN0eC5jbG9zZVBhdGgoKTtcblx0ICAgIGN0eC5maWxsKCk7XG5cdCAgfSxcblx0ICBjb21wb25lbnRXaWxsVW5tb3VudDogZnVuY3Rpb24gY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG5cdCAgICB0aGlzLnN0YXRlLnN0b3JlLnN0b3AoKTtcblx0ICB9LFxuXHQgIHB1c2hCbG90OiBmdW5jdGlvbiBwdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpIHtcblx0ICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cdFxuXHQgICAgdmFyIGVsID0gdGhpcy5yZWZzLmNhbnZhcztcblx0XG5cdCAgICAvLyAwLjEzIHN1cHBvcnRcblx0ICAgIGlmIChlbCBpbnN0YW5jZW9mIHdpbmRvdy5IVE1MQ2FudmFzRWxlbWVudCA9PT0gZmFsc2UpIHtcblx0ICAgICAgZWwgPSBlbC5nZXRET01Ob2RlKCk7XG5cdCAgICB9XG5cdFxuXHQgICAgdmFyIF9lbCRnZXRCb3VuZGluZ0NsaWVudCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLFxuXHQgICAgICAgIHRvcCA9IF9lbCRnZXRCb3VuZGluZ0NsaWVudC50b3AsXG5cdCAgICAgICAgYm90dG9tID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmJvdHRvbSxcblx0ICAgICAgICBsZWZ0ID0gX2VsJGdldEJvdW5kaW5nQ2xpZW50LmxlZnQsXG5cdCAgICAgICAgcmlnaHQgPSBfZWwkZ2V0Qm91bmRpbmdDbGllbnQucmlnaHQ7XG5cdFxuXHQgICAgdmFyIF93aW5kb3ckZ2V0Q29tcHV0ZWRTdCA9IHdpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsKSxcblx0ICAgICAgICBjb2xvciA9IF93aW5kb3ckZ2V0Q29tcHV0ZWRTdC5jb2xvcjtcblx0XG5cdCAgICB2YXIgY3R4ID0gdGhpcy5zdGF0ZS5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKTtcblx0ICAgIHZhciBkZW5zaXR5ID0gcGl4ZWxSYXRpbyhjdHgpO1xuXHQgICAgdmFyIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcblx0ICAgIHZhciB3aWR0aCA9IHJpZ2h0IC0gbGVmdDtcblx0ICAgIHZhciByYWRpdXMgPSBFcXVhdGlvbnMuZ2V0TWF4UmFkaXVzKGhlaWdodCwgd2lkdGgsIHRoaXMucHJvcHMucmFkaXVzKTtcblx0XG5cdCAgICB0aGlzLnNldFN0YXRlKHsgY29sb3I6IGNvbG9yLCBjdHg6IGN0eCwgZGVuc2l0eTogZGVuc2l0eSwgaGVpZ2h0OiBoZWlnaHQsIHdpZHRoOiB3aWR0aCB9LCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIF90aGlzLnN0YXRlLnN0b3JlLmFkZCh7XG5cdCAgICAgICAgZHVyYXRpb246IF90aGlzLnByb3BzLmR1cmF0aW9uLFxuXHQgICAgICAgIG1vdXNlRG93bjogdGltZVN0YW1wLFxuXHQgICAgICAgIG1vdXNlVXA6IDAsXG5cdCAgICAgICAgcmFkaXVzOiByYWRpdXMsXG5cdCAgICAgICAgeDogY2xpZW50WCAtIGxlZnQsXG5cdCAgICAgICAgeTogY2xpZW50WSAtIHRvcFxuXHQgICAgICB9KTtcblx0ICAgIH0pO1xuXHQgIH0sXG5cdCAgcmVuZGVyOiBmdW5jdGlvbiByZW5kZXIoKSB7XG5cdCAgICB2YXIgX3N0YXRlMyA9IHRoaXMuc3RhdGUsXG5cdCAgICAgICAgZGVuc2l0eSA9IF9zdGF0ZTMuZGVuc2l0eSxcblx0ICAgICAgICBoZWlnaHQgPSBfc3RhdGUzLmhlaWdodCxcblx0ICAgICAgICB3aWR0aCA9IF9zdGF0ZTMud2lkdGgsXG5cdCAgICAgICAgdG91Y2hFdmVudHMgPSBfc3RhdGUzLnRvdWNoRXZlbnRzO1xuXHRcblx0XG5cdCAgICByZXR1cm4gUmVhY3QuY3JlYXRlRWxlbWVudCgnY2FudmFzJywgX2V4dGVuZHMoeyBjbGFzc05hbWU6ICdpbmsnLFxuXHQgICAgICByZWY6ICdjYW52YXMnLFxuXHQgICAgICBzdHlsZTogX2V4dGVuZHMoe30sIFNUWUxFLCB0aGlzLnByb3BzLnN0eWxlKSxcblx0ICAgICAgaGVpZ2h0OiBoZWlnaHQgKiBkZW5zaXR5LFxuXHQgICAgICB3aWR0aDogd2lkdGggKiBkZW5zaXR5LFxuXHQgICAgICBvbkRyYWdPdmVyOiB0aGlzLl9vblJlbGVhc2Vcblx0ICAgIH0sIHRvdWNoRXZlbnRzKSk7XG5cdCAgfSxcblx0ICBfb25QcmVzczogZnVuY3Rpb24gX29uUHJlc3MoZSkge1xuXHQgICAgdmFyIGJ1dHRvbiA9IGUuYnV0dG9uLFxuXHQgICAgICAgIGN0cmxLZXkgPSBlLmN0cmxLZXksXG5cdCAgICAgICAgY2xpZW50WCA9IGUuY2xpZW50WCxcblx0ICAgICAgICBjbGllbnRZID0gZS5jbGllbnRZLFxuXHQgICAgICAgIGNoYW5nZWRUb3VjaGVzID0gZS5jaGFuZ2VkVG91Y2hlcztcblx0XG5cdCAgICB2YXIgdGltZVN0YW1wID0gRGF0ZS5ub3coKTtcblx0XG5cdCAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFuZ2VkVG91Y2hlcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIHZhciBfY2hhbmdlZFRvdWNoZXMkaSA9IGNoYW5nZWRUb3VjaGVzW2ldLFxuXHQgICAgICAgICAgICBfY2xpZW50WCA9IF9jaGFuZ2VkVG91Y2hlcyRpLmNsaWVudFgsXG5cdCAgICAgICAgICAgIF9jbGllbnRZID0gX2NoYW5nZWRUb3VjaGVzJGkuY2xpZW50WTtcblx0XG5cdCAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIF9jbGllbnRYLCBfY2xpZW50WSk7XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSBpZiAoYnV0dG9uID09PSBNT1VTRV9MRUZUICYmICFjdHJsS2V5KSB7XG5cdCAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKTtcblx0ICAgIH1cblx0ICB9LFxuXHQgIF9vblJlbGVhc2U6IGZ1bmN0aW9uIF9vblJlbGVhc2UoKSB7XG5cdCAgICB0aGlzLnN0YXRlLnN0b3JlLnJlbGVhc2UoRGF0ZS5ub3coKSk7XG5cdCAgfVxuXHR9KTtcblx0XG5cdG1vZHVsZS5leHBvcnRzID0gSW5rO1xuXG4vKioqLyB9LFxuLyogMSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKSB7XG5cblx0J3VzZSBzdHJpY3QnO1xuXHRcblx0dmFyIGVhc2luZyA9IF9fd2VicGFja19yZXF1aXJlX18oMyk7XG5cdHZhciBTUVJUXzIgPSBNYXRoLnNxcnQoMik7XG5cdHZhciBjb3MgPSBNYXRoLmNvcyxcblx0ICAgIG1heCA9IE1hdGgubWF4LFxuXHQgICAgbWluID0gTWF0aC5taW47XG5cdFxuXHRcblx0ZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuXHQgIHJldHVybiBtaW4oYmxvdC5kdXJhdGlvbiwgRGF0ZS5ub3coKSAtIGJsb3QubW91c2VEb3duKTtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG5cdCAgcmV0dXJuIGJsb3QubW91c2VVcCA+IDAgPyBEYXRlLm5vdygpIC0gYmxvdC5tb3VzZVVwIDogMDtcblx0fVxuXHRcblx0ZnVuY3Rpb24gZ2V0UmFkaXVzKGJsb3QpIHtcblx0ICB2YXIgZHVyYXRpb24gPSBibG90LmR1cmF0aW9uLFxuXHQgICAgICByYWRpdXMgPSBibG90LnJhZGl1cztcblx0XG5cdFxuXHQgIHZhciBkb3duID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODU7XG5cdCAgdmFyIHVwID0gZWFzaW5nKGdldFJlbGVhc2UoYmxvdCksIDAsIHJhZGl1cywgZHVyYXRpb24pICogMC4xNTtcblx0ICB2YXIgdW5kdWxhdGlvbiA9IHJhZGl1cyAqIDAuMDIgKiBjb3MoRGF0ZS5ub3coKSAvIGR1cmF0aW9uKTtcblx0XG5cdCAgcmV0dXJuIG1heCgwLCBkb3duICsgdXAgKyB1bmR1bGF0aW9uKTtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSB7XG5cdCAgZ2V0TWF4UmFkaXVzOiBmdW5jdGlvbiBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG5cdCAgICByZXR1cm4gbWluKG1heChoZWlnaHQsIHdpZHRoKSAqIDAuNSwgcmFkaXVzKTtcblx0ICB9LFxuXHQgIGdldEJsb3RPcGFjaXR5OiBmdW5jdGlvbiBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG5cdCAgICByZXR1cm4gZWFzaW5nKGdldFJlbGVhc2UoYmxvdCksIG9wYWNpdHksIC1vcGFjaXR5LCBibG90LmR1cmF0aW9uKTtcblx0ICB9LFxuXHQgIGdldEJsb3RPdXRlck9wYWNpdHk6IGZ1bmN0aW9uIGdldEJsb3RPdXRlck9wYWNpdHkoYmxvdCwgb3BhY2l0eSkge1xuXHQgICAgcmV0dXJuIG1pbih0aGlzLmdldEJsb3RPcGFjaXR5KGJsb3QsIG9wYWNpdHkpLCBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKTtcblx0ICB9LFxuXHQgIGdldEJsb3RTaGlmdFg6IGZ1bmN0aW9uIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcblx0ICAgIHJldHVybiBtaW4oMSwgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKHdpZHRoIC8gMiAtIGJsb3QueCk7XG5cdCAgfSxcblx0ICBnZXRCbG90U2hpZnRZOiBmdW5jdGlvbiBnZXRCbG90U2hpZnRZKGJsb3QsIHNpemUsIGhlaWdodCkge1xuXHQgICAgcmV0dXJuIG1pbigxLCBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAoaGVpZ2h0IC8gMiAtIGJsb3QueSk7XG5cdCAgfSxcblx0ICBnZXRCbG90U2NhbGU6IGZ1bmN0aW9uIGdldEJsb3RTY2FsZShibG90KSB7XG5cdCAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXM7XG5cdCAgfVxuXHR9O1xuXG4vKioqLyB9LFxuLyogMiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IHtcblx0ICBib3JkZXJSYWRpdXM6IFwiaW5oZXJpdFwiLFxuXHQgIGhlaWdodDogXCIxMDAlXCIsXG5cdCAgbGVmdDogMCxcblx0ICBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLFxuXHQgIHRvcDogMCxcblx0ICB3aWR0aDogXCIxMDAlXCJcblx0fTtcblxuLyoqKi8gfSxcbi8qIDMgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdFwidXNlIHN0cmljdFwiO1xuXHRcblx0LyoqXG5cdCAqIEB0IGlzIHRoZSBjdXJyZW50IHRpbWUgKG9yIHBvc2l0aW9uKSBvZiB0aGUgdHdlZW4uIFRoaXMgY2FuIGJlIHNlY29uZHMgb3IgZnJhbWVzLCBzdGVwcywgc2Vjb25kcywgbXMsIHdoYXRldmVyIOKAkyBhcyBsb25nIGFzIHRoZSB1bml0IGlzIHRoZSBzYW1lIGFzIGlzIHVzZWQgZm9yIHRoZSB0b3RhbCB0aW1lIFszXS5cblx0ICogQGIgaXMgdGhlIGJlZ2lubmluZyB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG5cdCAqIEBjIGlzIHRoZSBjaGFuZ2UgYmV0d2VlbiB0aGUgYmVnaW5uaW5nIGFuZCBkZXN0aW5hdGlvbiB2YWx1ZSBvZiB0aGUgcHJvcGVydHkuXG5cdCAqIEBkIGlzIHRoZSB0b3RhbCB0aW1lIG9mIHRoZSB0d2Vlbi5cblx0ICovXG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVhc2VPdXRRdWludCh0LCBiLCBjLCBkKSB7XG5cdCAgcmV0dXJuIGMgKiAoKHQgPSB0IC8gZCAtIDEpICogdCAqIHQgKiB0ICogdCArIDEpICsgYjtcblx0fTtcblxuLyoqKi8gfSxcbi8qIDQgKi9cbi8qKiovIGZ1bmN0aW9uKG1vZHVsZSwgZXhwb3J0cykge1xuXG5cdCd1c2Ugc3RyaWN0Jztcblx0XG5cdHZhciBib29sID0gZmFsc2U7XG5cdFxuXHRpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICBib29sID0gJ29udG91Y2hzdGFydCcgaW4gd2luZG93IHx8IHdpbmRvdy5Eb2N1bWVudFRvdWNoICYmIGRvY3VtZW50IGluc3RhbmNlb2YgRG9jdW1lbnRUb3VjaDtcblx0fVxuXHRcblx0bW9kdWxlLmV4cG9ydHMgPSBib29sO1xuXG4vKioqLyB9LFxuLyogNSAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHQvLyBHb29kIHN0dWZmIGhlcmU6XG5cdC8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblx0XG5cdG1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKGNvbnRleHQpIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRldmljZVBpeGVsUmF0aW8gPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICB2YXIgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IGNvbnRleHQub0JhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHwgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvIHx8IDE7XG5cdFxuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvO1xuXHR9O1xuXG4vKioqLyB9LFxuLyogNiAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIFB1cmUocHJvcHMsIHN0YXRlKSB7XG5cdCAgZm9yICh2YXIgcCBpbiBwcm9wcykge1xuXHQgICAgaWYgKHRoaXMucHJvcHNbcF0gIT09IHByb3BzW3BdKSByZXR1cm4gdHJ1ZTtcblx0ICB9XG5cdFxuXHQgIGZvciAodmFyIHMgaW4gc3RhdGUpIHtcblx0ICAgIGlmICh0aGlzLnN0YXRlW3NdICE9PSBzdGF0ZVtzXSkgcmV0dXJuIHRydWU7XG5cdCAgfVxuXHRcblx0ICByZXR1cm4gZmFsc2U7XG5cdH07XG5cbi8qKiovIH0sXG4vKiA3ICovXG4vKioqLyBmdW5jdGlvbihtb2R1bGUsIGV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pIHtcblxuXHQndXNlIHN0cmljdCc7XG5cdFxuXHQvKipcblx0ICogSW5rIFN0b3JlXG5cdCAqIEtlZXBzIHRyYWNrIG9mIGNoYW5nZXMgdG8gcmlwcGxlIGVwaWNlbnRlcnNcblx0ICogc28gdGhhdCA8SW5rIC8+IGNhbiBmb2N1cyBvbiByZW5kZXJpbmcgdGhlbS5cblx0ICovXG5cdFxuXHR2YXIgRXF1YXRpb25zID0gX193ZWJwYWNrX3JlcXVpcmVfXygxKTtcblx0XG5cdHZhciBraWxsU3RhbGUgPSBmdW5jdGlvbiBraWxsU3RhbGUoX3JlZikge1xuXHQgIHZhciBtb3VzZVVwID0gX3JlZi5tb3VzZVVwLFxuXHQgICAgICBkdXJhdGlvbiA9IF9yZWYuZHVyYXRpb247XG5cdCAgcmV0dXJuICFtb3VzZVVwIHx8IERhdGUubm93KCkgLSBtb3VzZVVwIDwgZHVyYXRpb247XG5cdH07XG5cdFxuXHRtb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChwdWJsaWNpemUpIHtcblx0ICB2YXIgX2RhdGEgPSBbXTtcblx0ICB2YXIgX3BsYXlpbmcgPSBmYWxzZTtcblx0ICB2YXIgX2ZyYW1lID0gdm9pZCAwO1xuXHRcblx0ICB2YXIgU3RvcmUgPSB7XG5cdCAgICBlYWNoOiBmdW5jdGlvbiBlYWNoKGNhbGxiYWNrLCBzY29wZSkge1xuXHQgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICAgIGNhbGxiYWNrLmNhbGwoc2NvcGUsIF9kYXRhW2ldKTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0ICAgIHBsYXk6IGZ1bmN0aW9uIHBsYXkoKSB7XG5cdCAgICAgIGlmICghX3BsYXlpbmcpIHtcblx0ICAgICAgICBfcGxheWluZyA9IHRydWU7XG5cdCAgICAgICAgU3RvcmUudXBkYXRlKCk7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdCAgICBzdG9wOiBmdW5jdGlvbiBzdG9wKCkge1xuXHQgICAgICBfcGxheWluZyA9IGZhbHNlO1xuXHQgICAgICBjYW5jZWxBbmltYXRpb25GcmFtZShfZnJhbWUpO1xuXHQgICAgfSxcblx0ICAgIGdldFRvdGFsT3BhY2l0eTogZnVuY3Rpb24gZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcblx0ICAgICAgdmFyIGFuc3dlciA9IDA7XG5cdFxuXHQgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IF9kYXRhLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICAgIGFuc3dlciArPSBFcXVhdGlvbnMuZ2V0QmxvdE91dGVyT3BhY2l0eShfZGF0YVtpXSwgb3BhY2l0eSk7XG5cdCAgICAgIH1cblx0XG5cdCAgICAgIHJldHVybiBhbnN3ZXI7XG5cdCAgICB9LFxuXHQgICAgdXBkYXRlOiBmdW5jdGlvbiB1cGRhdGUoKSB7XG5cdCAgICAgIF9kYXRhID0gX2RhdGEuZmlsdGVyKGtpbGxTdGFsZSk7XG5cdFxuXHQgICAgICBpZiAoX2RhdGEubGVuZ3RoKSB7XG5cdCAgICAgICAgX2ZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKFN0b3JlLnVwZGF0ZSk7XG5cdCAgICAgICAgcHVibGljaXplKCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgU3RvcmUuc3RvcCgpO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHQgICAgYWRkOiBmdW5jdGlvbiBhZGQocHJvcHMpIHtcblx0ICAgICAgX2RhdGEucHVzaChwcm9wcyk7XG5cdCAgICAgIFN0b3JlLnBsYXkoKTtcblx0ICAgIH0sXG5cdCAgICByZWxlYXNlOiBmdW5jdGlvbiByZWxlYXNlKHRpbWUpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IF9kYXRhLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdCAgICAgICAgaWYgKCFfZGF0YVtpXS5tb3VzZVVwKSB7XG5cdCAgICAgICAgICByZXR1cm4gX2RhdGFbaV0ubW91c2VVcCA9IHRpbWU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0XG5cdCAgcmV0dXJuIFN0b3JlO1xuXHR9O1xuXG4vKioqLyB9LFxuLyogOCAqL1xuLyoqKi8gZnVuY3Rpb24obW9kdWxlLCBleHBvcnRzKSB7XG5cblx0bW9kdWxlLmV4cG9ydHMgPSByZXF1aXJlKFwicmVhY3RcIik7XG5cbi8qKiovIH1cbi8qKioqKiovIF0pO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyBpbmsuanMiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSlcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcblxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0ZXhwb3J0czoge30sXG4gXHRcdFx0aWQ6IG1vZHVsZUlkLFxuIFx0XHRcdGxvYWRlZDogZmFsc2VcbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubG9hZGVkID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuIFx0Ly8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4gXHRyZXR1cm4gX193ZWJwYWNrX3JlcXVpcmVfXygwKTtcblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyB3ZWJwYWNrL2Jvb3RzdHJhcCA2ODhiM2JkMzRhOTMxMGZlOGIwNSIsIi8qKlxuICogSW5rXG4gKiBGaWxscyBhIGNvbnRhaW5lciB3aXRoIGFuIFNWRyBvYmplY3QgdGhhdCBwcm92aWRlcyBmZWVkYmFjayBvbiBtb3VzZS90b3VjaFxuICogZXZlbnRzIHdpdGggYSByaXBwbGluZyBwb29sLlxuICovXG5cbmxldCBIQVNfVE9VQ0ggID0gcmVxdWlyZSgnLi91dGlsL2hhc1RvdWNoJylcbmxldCBNT1VTRV9MRUZUID0gMFxubGV0IHBpeGVsUmF0aW8gPSByZXF1aXJlKCcuL3V0aWwvcGl4ZWxSYXRpbycpXG5sZXQgUmVhY3QgICAgICA9IHJlcXVpcmUoJ3JlYWN0JylcbmxldCBTVFlMRSAgICAgID0gcmVxdWlyZSgnLi9zdHlsZScpXG5sZXQgU3RvcmUgICAgICA9IHJlcXVpcmUoJy4vdXRpbC9zdG9yZScpXG5sZXQgVHlwZXMgICAgICA9IFJlYWN0LlByb3BUeXBlc1xubGV0IFRBVSAgICAgICAgPSBNYXRoLlBJICogMlxubGV0IEVxdWF0aW9ucyAgPSByZXF1aXJlKCcuL3V0aWwvZXF1YXRpb25zJylcbmxldCBQdXJlICAgICAgID0gcmVxdWlyZSgnLi91dGlsL3B1cmUnKVxuXG5sZXQgSW5rID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xuXG4gIHNob3VsZENvbXBvbmVudFVwZGF0ZTogUHVyZSxcblxuICBwcm9wVHlwZXM6IHtcbiAgICBiYWNrZ3JvdW5kIDogVHlwZXMuYm9vbCxcbiAgICBkdXJhdGlvbiAgIDogVHlwZXMubnVtYmVyLFxuICAgIG9wYWNpdHkgICAgOiBUeXBlcy5udW1iZXIsXG4gICAgcmFkaXVzICAgICA6IFR5cGVzLm51bWJlcixcbiAgICByZWNlbnRlciAgIDogVHlwZXMuYm9vbCxcbiAgICBoYXNUb3VjaCAgIDogVHlwZXMuYm9vbFxuICB9LFxuXG4gIGdldERlZmF1bHRQcm9wcygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYmFja2dyb3VuZCA6IHRydWUsXG4gICAgICBkdXJhdGlvbiAgIDogMTAwMCxcbiAgICAgIG9wYWNpdHkgICAgOiAwLjI1LFxuICAgICAgcmFkaXVzICAgICA6IDE1MCxcbiAgICAgIHJlY2VudGVyICAgOiB0cnVlLFxuICAgICAgaGFzVG91Y2ggICA6IEhBU19UT1VDSFxuICAgIH1cbiAgfSxcblxuICBnZXRJbml0aWFsU3RhdGUoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGNvbG9yICAgICAgIDogJ3RyYW5zcGFyZW50JyxcbiAgICAgIGRlbnNpdHkgICAgIDogMSxcbiAgICAgIGhlaWdodCAgICAgIDogMCxcbiAgICAgIHN0b3JlICAgICAgIDogU3RvcmUodGhpcy50aWNrKSxcbiAgICAgIHRvdWNoRXZlbnRzIDogdGhpcy50b3VjaEV2ZW50cygpLFxuICAgICAgd2lkdGggICAgICAgOiAwXG4gICAgfVxuICB9LFxuXG4gIHRvdWNoRXZlbnRzKCkge1xuICAgIGlmICh0aGlzLnByb3BzLmhhc1RvdWNoKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvblRvdWNoU3RhcnQgIDogdGhpcy5fb25QcmVzcyxcbiAgICAgICAgb25Ub3VjaEVuZCAgICA6IHRoaXMuX29uUmVsZWFzZSxcbiAgICAgICAgb25Ub3VjaENhbmNlbCA6IHRoaXMuX29uUmVsZWFzZVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBvbk1vdXNlRG93biAgIDogdGhpcy5fb25QcmVzcyxcbiAgICAgICAgb25Nb3VzZVVwICAgICA6IHRoaXMuX29uUmVsZWFzZSxcbiAgICAgICAgb25Nb3VzZUxlYXZlICA6IHRoaXMuX29uUmVsZWFzZVxuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICB0aWNrKCkge1xuICAgIGxldCB7IGN0eCwgY29sb3IsIGRlbnNpdHksIGhlaWdodCwgd2lkdGgsIHN0b3JlIH0gPSB0aGlzLnN0YXRlXG5cbiAgICBjdHguc2F2ZSgpXG5cbiAgICBjdHguc2NhbGUoZGVuc2l0eSwgZGVuc2l0eSlcblxuICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgd2lkdGgsIGhlaWdodClcblxuICAgIGN0eC5maWxsU3R5bGUgPSBjb2xvclxuXG4gICAgaWYgKHRoaXMucHJvcHMuYmFja2dyb3VuZCkge1xuICAgICAgY3R4Lmdsb2JhbEFscGhhID0gc3RvcmUuZ2V0VG90YWxPcGFjaXR5KHRoaXMucHJvcHMub3BhY2l0eSlcbiAgICAgIGN0eC5maWxsUmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KVxuICAgIH1cblxuICAgIHN0b3JlLmVhY2godGhpcy5tYWtlQmxvdCwgdGhpcylcblxuICAgIGN0eC5yZXN0b3JlKClcbiAgfSxcblxuICBtYWtlQmxvdChibG90KSB7XG4gICAgbGV0IHsgY3R4LCBoZWlnaHQsIHdpZHRoIH0gPSB0aGlzLnN0YXRlXG4gICAgbGV0IHsgeCwgeSwgcmFkaXVzIH0gPSBibG90XG5cbiAgICBjdHguZ2xvYmFsQWxwaGEgPSBFcXVhdGlvbnMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgdGhpcy5wcm9wcy5vcGFjaXR5KVxuICAgIGN0eC5iZWdpblBhdGgoKVxuXG4gICAgaWYgKHRoaXMucHJvcHMucmVjZW50ZXIpIHtcbiAgICAgIGxldCBzaXplID0gTWF0aC5tYXgoaGVpZ2h0LCB3aWR0aClcblxuICAgICAgeCArPSBFcXVhdGlvbnMuZ2V0QmxvdFNoaWZ0WChibG90LCBzaXplLCB3aWR0aClcbiAgICAgIHkgKz0gRXF1YXRpb25zLmdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KVxuICAgIH1cblxuICAgIGN0eC5hcmMoeCwgeSwgcmFkaXVzICogRXF1YXRpb25zLmdldEJsb3RTY2FsZShibG90KSwgMCwgVEFVKVxuXG4gICAgY3R4LmNsb3NlUGF0aCgpXG4gICAgY3R4LmZpbGwoKVxuICB9LFxuXG4gIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUuc3RvcCgpXG4gIH0sXG5cbiAgcHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKSB7XG4gICAgbGV0IGVsID0gdGhpcy5yZWZzLmNhbnZhc1xuXG4gICAgLy8gMC4xMyBzdXBwb3J0XG4gICAgaWYgKGVsIGluc3RhbmNlb2Ygd2luZG93LkhUTUxDYW52YXNFbGVtZW50ID09PSBmYWxzZSkge1xuICAgICAgZWwgPSBlbC5nZXRET01Ob2RlKClcbiAgICB9XG5cbiAgICBsZXQgeyB0b3AsIGJvdHRvbSwgbGVmdCwgcmlnaHQgfSA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gICAgbGV0IHsgY29sb3IgfSAgICAgICAgICAgICAgICAgICAgPSB3aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZShlbClcblxuICAgIGxldCBjdHggICAgID0gdGhpcy5zdGF0ZS5jdHggfHwgZWwuZ2V0Q29udGV4dCgnMmQnKTtcbiAgICBsZXQgZGVuc2l0eSA9IHBpeGVsUmF0aW8oY3R4KVxuICAgIGxldCBoZWlnaHQgID0gYm90dG9tIC0gdG9wXG4gICAgbGV0IHdpZHRoICAgPSByaWdodCAtIGxlZnRcbiAgICBsZXQgcmFkaXVzICA9IEVxdWF0aW9ucy5nZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgdGhpcy5wcm9wcy5yYWRpdXMpXG5cbiAgICB0aGlzLnNldFN0YXRlKHsgY29sb3IsIGN0eCwgZGVuc2l0eSwgaGVpZ2h0LCB3aWR0aCB9LCAoKSA9PiB7XG4gICAgICB0aGlzLnN0YXRlLnN0b3JlLmFkZCh7XG4gICAgICAgIGR1cmF0aW9uICA6IHRoaXMucHJvcHMuZHVyYXRpb24sXG4gICAgICAgIG1vdXNlRG93biA6IHRpbWVTdGFtcCxcbiAgICAgICAgbW91c2VVcCAgIDogMCxcbiAgICAgICAgcmFkaXVzICAgIDogcmFkaXVzLFxuICAgICAgICB4ICAgICAgICAgOiBjbGllbnRYIC0gbGVmdCxcbiAgICAgICAgeSAgICAgICAgIDogY2xpZW50WSAtIHRvcFxuICAgICAgfSlcbiAgICB9KVxuICB9LFxuXG4gIHJlbmRlcigpIHtcbiAgICBsZXQgeyBkZW5zaXR5LCBoZWlnaHQsIHdpZHRoLCB0b3VjaEV2ZW50cyB9ID0gdGhpcy5zdGF0ZVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxjYW52YXMgY2xhc3NOYW1lPVwiaW5rXCJcbiAgICAgICAgICAgICAgcmVmPVwiY2FudmFzXCJcbiAgICAgICAgICAgICAgc3R5bGU9e3sgLi4uU1RZTEUsIC4uLnRoaXMucHJvcHMuc3R5bGUgfX1cbiAgICAgICAgICAgICAgaGVpZ2h0PXsgaGVpZ2h0ICogZGVuc2l0eSB9XG4gICAgICAgICAgICAgIHdpZHRoPXsgd2lkdGggKiBkZW5zaXR5IH1cbiAgICAgICAgICAgICAgb25EcmFnT3Zlcj17IHRoaXMuX29uUmVsZWFzZSB9XG4gICAgICAgICAgICAgIHsgLi4udG91Y2hFdmVudHMgfSAvPlxuICAgIClcbiAgfSxcblxuICBfb25QcmVzcyhlKSB7XG4gICAgbGV0IHsgYnV0dG9uLCBjdHJsS2V5LCBjbGllbnRYLCBjbGllbnRZLCBjaGFuZ2VkVG91Y2hlcyB9ID0gZVxuICAgIGxldCB0aW1lU3RhbXAgPSBEYXRlLm5vdygpXG5cbiAgICBpZiAoY2hhbmdlZFRvdWNoZXMpIHtcbiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgY2hhbmdlZFRvdWNoZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgbGV0IHsgY2xpZW50WCwgY2xpZW50WSB9ID0gY2hhbmdlZFRvdWNoZXNbaV1cbiAgICAgICAgdGhpcy5wdXNoQmxvdCh0aW1lU3RhbXAsIGNsaWVudFgsIGNsaWVudFkpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChidXR0b24gPT09IE1PVVNFX0xFRlQgJiYgIWN0cmxLZXkpIHtcbiAgICAgIHRoaXMucHVzaEJsb3QodGltZVN0YW1wLCBjbGllbnRYLCBjbGllbnRZKVxuICAgIH1cbiAgfSxcblxuICBfb25SZWxlYXNlKCkge1xuICAgIHRoaXMuc3RhdGUuc3RvcmUucmVsZWFzZShEYXRlLm5vdygpKVxuICB9XG59KVxuXG5tb2R1bGUuZXhwb3J0cyA9IElua1xuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL2luZGV4LmpzIiwibGV0IGVhc2luZyA9IHJlcXVpcmUoJy4vZWFzaW5nJylcbmxldCBTUVJUXzIgPSBNYXRoLnNxcnQoMilcbmxldCB7IGNvcywgbWF4LCBtaW4gfSA9IE1hdGhcblxuZnVuY3Rpb24gZ2V0UHJlc3MoYmxvdCkge1xuICByZXR1cm4gbWluKGJsb3QuZHVyYXRpb24sIERhdGUubm93KCkgLSBibG90Lm1vdXNlRG93bilcbn1cblxuZnVuY3Rpb24gZ2V0UmVsZWFzZShibG90KSB7XG4gIHJldHVybiBibG90Lm1vdXNlVXAgPiAwID8gRGF0ZS5ub3coKSAtIGJsb3QubW91c2VVcCA6IDBcbn1cblxuZnVuY3Rpb24gZ2V0UmFkaXVzKGJsb3QpIHtcbiAgbGV0IHsgZHVyYXRpb24sIHJhZGl1cyB9ID0gYmxvdFxuXG4gIGxldCBkb3duICAgICAgID0gZWFzaW5nKGdldFByZXNzKGJsb3QpLCAwLCByYWRpdXMsIGR1cmF0aW9uKSAqIDAuODVcbiAgbGV0IHVwICAgICAgICAgPSBlYXNpbmcoZ2V0UmVsZWFzZShibG90KSwgMCwgcmFkaXVzLCBkdXJhdGlvbikgKiAwLjE1XG4gIGxldCB1bmR1bGF0aW9uID0gcmFkaXVzICogMC4wMiAqIGNvcyhEYXRlLm5vdygpIC8gZHVyYXRpb24pXG5cbiAgcmV0dXJuIG1heCgwLCBkb3duICsgdXAgKyB1bmR1bGF0aW9uKVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcblxuICBnZXRNYXhSYWRpdXMoaGVpZ2h0LCB3aWR0aCwgcmFkaXVzKSB7XG4gICAgcmV0dXJuIG1pbihtYXgoaGVpZ2h0LCB3aWR0aCkgKiAwLjUsIHJhZGl1cylcbiAgfSxcblxuICBnZXRCbG90T3BhY2l0eShibG90LCBvcGFjaXR5KSB7XG4gICAgcmV0dXJuIGVhc2luZyhnZXRSZWxlYXNlKGJsb3QpLCBvcGFjaXR5LCAtb3BhY2l0eSwgYmxvdC5kdXJhdGlvbilcbiAgfSxcblxuICBnZXRCbG90T3V0ZXJPcGFjaXR5KGJsb3QsIG9wYWNpdHkpIHtcbiAgICByZXR1cm4gbWluKHRoaXMuZ2V0QmxvdE9wYWNpdHkoYmxvdCwgb3BhY2l0eSksXG4gICAgICAgICAgICAgICBlYXNpbmcoZ2V0UHJlc3MoYmxvdCksIDAsIDAuMywgYmxvdC5kdXJhdGlvbiAqIDMpKVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFgoYmxvdCwgc2l6ZSwgd2lkdGgpIHtcbiAgICByZXR1cm4gbWluKDEsXG4gICAgICAgICAgICAgICBnZXRSYWRpdXMoYmxvdCkgLyBzaXplICogMiAvIFNRUlRfMikgKiAod2lkdGggLyAyIC0gYmxvdC54KVxuICB9LFxuXG4gIGdldEJsb3RTaGlmdFkoYmxvdCwgc2l6ZSwgaGVpZ2h0KSB7XG4gICAgcmV0dXJuIG1pbigxLFxuICAgICAgICAgICAgICAgZ2V0UmFkaXVzKGJsb3QpIC8gc2l6ZSAqIDIgLyBTUVJUXzIpICogKGhlaWdodCAvIDIgLSBibG90LnkpXG4gIH0sXG5cbiAgZ2V0QmxvdFNjYWxlKGJsb3QpIHtcbiAgICByZXR1cm4gZ2V0UmFkaXVzKGJsb3QpIC8gYmxvdC5yYWRpdXNcbiAgfVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvZXF1YXRpb25zLmpzIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIGJvcmRlclJhZGl1czogXCJpbmhlcml0XCIsXG4gIGhlaWdodDogXCIxMDAlXCIsXG4gIGxlZnQ6IDAsXG4gIHBvc2l0aW9uOiBcImFic29sdXRlXCIsXG4gIHRvcDogMCxcbiAgd2lkdGg6IFwiMTAwJVwiXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvc3R5bGUuanMiLCIvKipcbiAqIEB0IGlzIHRoZSBjdXJyZW50IHRpbWUgKG9yIHBvc2l0aW9uKSBvZiB0aGUgdHdlZW4uIFRoaXMgY2FuIGJlIHNlY29uZHMgb3IgZnJhbWVzLCBzdGVwcywgc2Vjb25kcywgbXMsIHdoYXRldmVyIOKAkyBhcyBsb25nIGFzIHRoZSB1bml0IGlzIHRoZSBzYW1lIGFzIGlzIHVzZWQgZm9yIHRoZSB0b3RhbCB0aW1lIFszXS5cbiAqIEBiIGlzIHRoZSBiZWdpbm5pbmcgdmFsdWUgb2YgdGhlIHByb3BlcnR5LlxuICogQGMgaXMgdGhlIGNoYW5nZSBiZXR3ZWVuIHRoZSBiZWdpbm5pbmcgYW5kIGRlc3RpbmF0aW9uIHZhbHVlIG9mIHRoZSBwcm9wZXJ0eS5cbiAqIEBkIGlzIHRoZSB0b3RhbCB0aW1lIG9mIHRoZSB0d2Vlbi5cbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVhc2VPdXRRdWludCAodCwgYiwgYywgZCkge1xuICByZXR1cm4gYyooKHQ9dC9kLTEpKnQqdCp0KnQgKyAxKSArIGJcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlsL2Vhc2luZy5qcyIsInZhciBib29sID0gZmFsc2VcblxuaWYgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnKSB7XG4gIGJvb2wgPSAoJ29udG91Y2hzdGFydCcgaW4gd2luZG93KSB8fCB3aW5kb3cuRG9jdW1lbnRUb3VjaCAmJiBkb2N1bWVudCBpbnN0YW5jZW9mIERvY3VtZW50VG91Y2hcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBib29sXG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9oYXNUb3VjaC5qcyIsIi8vIEdvb2Qgc3R1ZmYgaGVyZTpcbi8vIGh0dHA6Ly93d3cuaHRtbDVyb2Nrcy5jb20vZW4vdHV0b3JpYWxzL2NhbnZhcy9oaWRwaS9cblxubW9kdWxlLmV4cG9ydHMgPSBjb250ZXh0ID0+IHtcbiAgbGV0IGRldmljZVBpeGVsUmF0aW8gID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMVxuICBsZXQgYmFja2luZ1N0b3JlUmF0aW8gPSBjb250ZXh0LndlYmtpdEJhY2tpbmdTdG9yZVBpeGVsUmF0aW8gfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5tb3pCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQubXNCYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0Lm9CYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGV4dC5iYWNraW5nU3RvcmVQaXhlbFJhdGlvICAgICAgIHx8IDFcblxuICByZXR1cm4gZGV2aWNlUGl4ZWxSYXRpbyAvIGJhY2tpbmdTdG9yZVJhdGlvXG59XG5cblxuXG4vLyBXRUJQQUNLIEZPT1RFUiAvL1xuLy8gLi9zcmMvdXRpbC9waXhlbFJhdGlvLmpzIiwibW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBQdXJlIChwcm9wcywgc3RhdGUpIHtcbiAgZm9yIChsZXQgcCBpbiBwcm9wcykge1xuICAgIGlmICh0aGlzLnByb3BzW3BdICE9PSBwcm9wc1twXSkgcmV0dXJuIHRydWVcbiAgfVxuXG4gIGZvciAobGV0IHMgaW4gc3RhdGUpIHtcbiAgICBpZiAodGhpcy5zdGF0ZVtzXSAhPT0gc3RhdGVbc10pIHJldHVybiB0cnVlXG4gIH1cblxuICByZXR1cm4gZmFsc2Vcbn1cblxuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL3NyYy91dGlsL3B1cmUuanMiLCIvKipcbiAqIEluayBTdG9yZVxuICogS2VlcHMgdHJhY2sgb2YgY2hhbmdlcyB0byByaXBwbGUgZXBpY2VudGVyc1xuICogc28gdGhhdCA8SW5rIC8+IGNhbiBmb2N1cyBvbiByZW5kZXJpbmcgdGhlbS5cbiAqL1xuXG52YXIgRXF1YXRpb25zID0gcmVxdWlyZSgnLi9lcXVhdGlvbnMnKVxuXG5sZXQga2lsbFN0YWxlID0gKHsgbW91c2VVcCwgZHVyYXRpb24gfSkgPT4gIW1vdXNlVXAgfHwgKERhdGUubm93KCkgLSBtb3VzZVVwKSA8IGR1cmF0aW9uXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24ocHVibGljaXplKSB7XG4gIGxldCBfZGF0YSAgICA9IFtdXG4gIGxldCBfcGxheWluZyA9IGZhbHNlXG4gIGxldCBfZnJhbWVcblxuICBsZXQgU3RvcmUgPSB7XG5cbiAgICBlYWNoKGNhbGxiYWNrLCBzY29wZSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBfZGF0YS5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgICAgY2FsbGJhY2suY2FsbChzY29wZSwgX2RhdGFbaV0pXG4gICAgICB9XG4gICAgfSxcblxuICAgIHBsYXkoKSB7XG4gICAgICBpZiAoIV9wbGF5aW5nKSB7XG4gICAgICAgIF9wbGF5aW5nID0gdHJ1ZVxuICAgICAgICBTdG9yZS51cGRhdGUoKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBzdG9wKCkge1xuICAgICAgX3BsYXlpbmcgPSBmYWxzZTtcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF9mcmFtZSlcbiAgICB9LFxuXG4gICAgZ2V0VG90YWxPcGFjaXR5KG9wYWNpdHkpIHtcbiAgICAgIGxldCBhbnN3ZXIgPSAwXG5cbiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gX2RhdGEubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICAgIGFuc3dlciArPSBFcXVhdGlvbnMuZ2V0QmxvdE91dGVyT3BhY2l0eShfZGF0YVtpXSwgb3BhY2l0eSlcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGFuc3dlclxuICAgIH0sXG5cbiAgICB1cGRhdGUoKSB7XG4gICAgICBfZGF0YSA9IF9kYXRhLmZpbHRlcihraWxsU3RhbGUpXG5cbiAgICAgIGlmIChfZGF0YS5sZW5ndGgpIHtcbiAgICAgICAgX2ZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKFN0b3JlLnVwZGF0ZSlcbiAgICAgICAgcHVibGljaXplKClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIFN0b3JlLnN0b3AoKVxuICAgICAgfVxuICAgIH0sXG5cbiAgICBhZGQocHJvcHMpIHtcbiAgICAgIF9kYXRhLnB1c2gocHJvcHMpXG4gICAgICBTdG9yZS5wbGF5KClcbiAgICB9LFxuXG4gICAgcmVsZWFzZSh0aW1lKSB7XG4gICAgICBmb3IgKGxldCBpID0gX2RhdGEubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHtcbiAgICAgICAgaWYgKCFfZGF0YVtpXS5tb3VzZVVwKSB7XG4gICAgICAgICAgcmV0dXJuIF9kYXRhW2ldLm1vdXNlVXAgPSB0aW1lXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfVxuXG4gIHJldHVybiBTdG9yZVxufVxuXG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vc3JjL3V0aWwvc3RvcmUuanMiLCJtb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoXCJyZWFjdFwiKTtcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIFdFQlBBQ0sgRk9PVEVSXG4vLyBleHRlcm5hbCBcInJlYWN0XCJcbi8vIG1vZHVsZSBpZCA9IDhcbi8vIG1vZHVsZSBjaHVua3MgPSAwIl0sInNvdXJjZVJvb3QiOiIifQ==